openapi: 3.0.3
info:
  title: Sales Automation Systems Client API
  description: |
    Real-time event tracking and webhook API for Sales Automation Systems. 
    This API allows you to send us real-time events from your website and customer systems, 
    and configure webhooks to receive our outbound lead data.

    ---

    ## üìπ Video Tutorials

    | Guide | Link |
    |-------|------|
    | Getting Started | [‚ñ∂Ô∏è Watch Setup Video](https://www.loom.com/share/10142595493d4523be825e872d413f91?sid=e1ea2827-7cce-4318-a489-c3f34ca6f3fa) |
    | HubSpot via Zapier | [‚ñ∂Ô∏è Watch Integration Video](https://www.loom.com/share/a489487de1844a54a6f318fb3ea23842?sid=dc22ac70-b823-401d-b9c0-b075b9dcdc90) |

    ---

    ## üîë Authentication

    Your **Client ID** in the URL is your authentication. No API keys needed.
    
    ```
    POST https://rest.salesautomation.systems/attribution/{your_client_id}
    ```

  version: 1.0.0
  contact:
    name: Sales Automation Systems
    url: https://salesautomation.systems

servers:
  - url: https://rest.salesautomation.systems
    description: Production server

tags:
  - name: Attribution
    description: Track attribution events for contacts or companies.

paths:
  /attribution/{client_id}:
    post:
      operationId: trackAttribution
      summary: Track Attribution Event
      description: |
        # üìç One Endpoint, Two Modes
        
        This endpoint tracks attribution for **individuals** or **companies** based on one simple rule:
        
        ---
        
        ## üéØ Which Field Should I Use?
        
        | I want to track... | Send this field | Don't send |
        |--------------------|-----------------|------------|
        | **A specific person** | `email` | `domain` |
        | **An entire company** | `domain` | `email` |
        
        > **That's it!** The system automatically knows what to do based on which field you include.
        
        ---
        
        ## ‚ö†Ô∏è Important: Know the Difference
        
        ### Tracking a Person (`email`)
        - Actions apply to **one individual**
        - Use for: personal sign-ups, individual meetings, per-user billing
        - `dnc` = blocks **just this person**
        - `paying_customer` = **this person** is a customer
        
        ### Tracking a Company (`domain`)
        - Actions apply to **the entire organization**
        - Use for: account-based marketing, company sign-ups, account billing
        - `dnc` = blocks **ALL employees** at this company
        - `paying_customer` = **the whole account** is a customer
        
        ---
        
        ## üö® Warning: DNC (Do Not Contact)
        
        | You send | What happens |
        |----------|--------------|
        | `"email": "john@acme.com"` + `"event_type": "dnc"` | Only John is blocked |
        | `"domain": "acme.com"` + `"event_type": "dnc"` | **Everyone at Acme is blocked!** |
        
        ---
        
        ## üìã Quick Examples
        
        **Track a person signing up:**
        ```json
        { "email": "john@acme.com", "event_type": "sign_up", "event_time": "..." }
        ```
        
        **Track a company signing up:**
        ```json
        { "domain": "acme.com", "event_type": "sign_up", "event_time": "..." }
        ```
        
      tags:
        - Attribution
      parameters:
        - name: client_id
          in: path
          required: true
          schema:
            type: string
          description: Your unique Client ID (this is your authentication)
          example: "abc123xyz"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AttributionRequest'
            examples:
              person_signup:
                summary: "üë§ Person: Sign Up"
                value:
                  email: "john.doe@example.com"
                  event_type: "sign_up"
                  event_time: "2025-06-30T14:30:00Z"
                  first_name: "John"
                  last_name: "Doe"
                  company_name: "Example Corp"
                  campaign_id: "summer_2025"
              person_meeting:
                summary: "üë§ Person: Meeting Booked"
                value:
                  email: "john.doe@example.com"
                  event_type: "meeting_booked"
                  event_time: "2025-06-30T14:30:00Z"
                  first_name: "John"
                  last_name: "Doe"
              person_paying:
                summary: "üë§ Person: Paying Customer"
                value:
                  email: "john.doe@example.com"
                  event_type: "paying_customer"
                  event_time: "2025-06-30T14:30:00Z"
                  first_name: "John"
                  last_name: "Doe"
                  company_name: "Example Corp"
              person_dnc:
                summary: "üë§ Person: Do Not Contact"
                value:
                  email: "jane.smith@example.com"
                  event_type: "dnc"
                  event_time: "2025-06-30T14:30:00Z"
              company_signup:
                summary: "üè¢ Company: Sign Up"
                value:
                  domain: "example.com"
                  event_type: "sign_up"
                  event_time: "2025-06-30T14:30:00Z"
                  company_name: "Example Corp"
                  campaign_id: "enterprise_q4"
              company_visitor:
                summary: "üè¢ Company: Website Visitor"
                value:
                  domain: "example.com"
                  event_type: "website_visitor"
                  event_time: "2025-06-30T14:30:00Z"
                  company_name: "Example Corp"
              company_paying:
                summary: "üè¢ Company: Paying Customer"
                value:
                  domain: "example.com"
                  event_type: "paying_customer"
                  event_time: "2025-06-30T14:30:00Z"
                  company_name: "Example Corp"
              company_dnc:
                summary: "üè¢‚ö†Ô∏è Company: Do Not Contact (blocks everyone!)"
                value:
                  domain: "example.com"
                  event_type: "dnc"
                  event_time: "2025-06-30T14:30:00Z"
                  company_name: "Example Corp"
      responses:
        '200':
          description: Event successfully recorded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AttributionResponse'
              example:
                status: "success"
                message: "Event processed successfully"
                event_id: "evt_abc123xyz"
        '400':
          description: Bad request - Invalid input data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: "error"
                message: "Invalid email or domain format"
        '401':
          description: Unauthorized - Invalid Client ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: "error"
                message: "Invalid Client ID"

components:
  schemas:
    EventType:
      type: string
      enum:
        - sign_up
        - meeting_booked
        - paying_customer
        - website_visitor
        - dnc
      description: |
        | Event | Description |
        |-------|-------------|
        | `sign_up` | New registration |
        | `meeting_booked` | Meeting scheduled |
        | `paying_customer` | Became a customer |
        | `website_visitor` | Visited website |
        | `dnc` | Do not contact |

    AttributionRequest:
      type: object
      required:
        - event_type
        - event_time
      properties:
        email:
          type: string
          format: email
          description: |
            ## üë§ For tracking a PERSON
            
            Include `email` when you want to track an **individual contact**.
            
            - Actions will apply to this specific person only
            - For `dnc`: blocks only this email address
            - For `paying_customer`: marks this individual as a customer
            
            > **Leave empty if using `domain` instead**
          example: "john.doe@example.com"
        domain:
          type: string
          description: |
            ## üè¢ For tracking a COMPANY
            
            Include `domain` when you want to track an **entire organization**.
            
            - Actions will apply to everyone at this company
            - For `dnc`: ‚ö†Ô∏è **blocks ALL employees at this domain!**
            - For `paying_customer`: marks the whole account as a customer
            
            > **Leave empty if using `email` instead**
          example: "example.com"
        event_type:
          allOf:
            - $ref: '#/components/schemas/EventType'
          description: |
            The type of event to record.
            
            ‚ö†Ô∏è **The impact depends on whether you sent `email` or `domain`!**
        event_time:
          type: string
          format: date-time
          description: When the event occurred (ISO 8601 format)
          example: "2025-06-30T14:30:00Z"
        first_name:
          type: string
          description: Person's first name (for person tracking)
          example: "John"
        last_name:
          type: string
          description: Person's last name (for person tracking)
          example: "Doe"
        company_name:
          type: string
          description: Company name (for reference)
          example: "Example Corp"
        campaign_id:
          type: string
          description: Campaign ID for attribution
          example: "summer_2025"

    AttributionResponse:
      type: object
      properties:
        status:
          type: string
          example: "success"
        message:
          type: string
        event_id:
          type: string
          description: Unique ID for this event

    ErrorResponse:
      type: object
      properties:
        status:
          type: string
          example: "error"
        message:
          type: string
